# ProteoViewer
<p align="center">
  <video src="assets/proteoviewer_demo.mp4"
         width="900"
         autoplay
         loop
         muted
         playsinline>
  </video>
</p>

ProteoViewer is an interactive visualization application for exploring analysis-ready outputs generated by [Proteoflux](https://github.com/Afanc/proteoflux).
It is designed as a *pure consumer* of ProteoFlux results and does **not** perform any preprocessing or statistical computation itself.

ProteoViewer can be used:
- locally, as a standalone desktop (Linux or Windows) application,
- centrally, as a multi-user web service (e.g. in a core facility),

---

## Key features

- Interactive exploration of **ProteoFlux** `.h5ad` results
- Quality control and preprocessing diagnostics
- PCA, MDS, and hierarchical clustering
- Differential expression analysis (volcano plots, shrinkage diagnostics)
- Feature-level trends across samples, conditions, and contrasts
- No recomputation: all results are rendered from precomputed values

---

## Installation (Python environment)

ProteoViewer is a Python application built on Panel, Bokeh, and the scientific Python ecosystem.

### Recommended: Conda / Mamba

```bash
conda create -n proteoviewer python=3.13
conda activate proteoviewer
pip install -r requirements.txt
```

### Alternative: virtualenv

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## Running ProteoViewer locally

From the repository root:

```bash
python app.py
```

For development with auto-reload:

```bash
panel serve app.py --autoreload
```

By default, ProteoViewer starts a local web server and opens the interface in your browser.
If it does not open by itself, try loading http://localhost:5006/

---

## Running ProteoViewer as a service (Linux)

ProteoViewer can be deployed as a persistent, multi-user web service (e.g. in a core facility).

A minimal example systemd unit file is provided in `proteoviewer.service`.
You will typically need to adapt:

- the Python environment path
- the working directory
- upload directories
- user permissions

Example:

```ini
[Service]
User=youruser
WorkingDirectory=/opt/ProteoViewer
Environment="PATH=/opt/conda/envs/proteoviewer/bin:/usr/bin"
EnvironmentFile=-/opt/Proteoviewer/proteoviewer-example.env
ExecStart=/opt/conda/envs/proteoviewer/bin/python app.py
Restart=always
```

Proteoviewer can be customized via an environment file when running as a service.
An example configuration is provided `proteoviewer-example.env`.
Edit this file to adjust:
- Facility logo path
- Default data directories
- Host/port settings
- Number of workers

---

## Windows executable (no Python required)

ProteoViewer can be distributed as a standalone Windows executable built with **PyInstaller**.

### Building locally

```bash
cd Proteoviewer
.venv\Scripts\activate.bat
python -m PyInstaller proteoviewer.spec
```

The executable will be created under:

```text
dist/proteoviewer/
```

### GitHub Actions builds

This repository includes a GitHub Actions workflow that automatically builds a Windows executable
on each release. The resulting `.zip` file can be downloaded directly from the GitHub Actions artifacts.

---

## Input data

ProteoViewer expects **ProteoFlux-generated** `.h5ad` files.
All statistics, clustering, and preprocessing steps must be computed by ProteoFlux.

ProteoViewer will **never** modify or recompute the underlying data.

---

## License

ProteoViewer is released under the **MIT License**.
See the `LICENSE` file for details.

---

## Relationship to ProteoFlux and Citation

ProteoViewer is a companion application to [Proteoflux](https://github.com/Afanc/proteoflux), but is developed and released as a separate repository to keep analysis and visualization concerns strictly separated.

If you use ProteoFlux in your work, please cite:

ProteoFlux v1.8.5.
Zenodo. https://doi.org/10.5281/zenodo.18640999

A peer-reviewed publication is currently under submission.
